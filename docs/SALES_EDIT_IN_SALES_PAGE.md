# โ๏ธ ุฅุถุงูุฉ ุฒุฑ ุงูุชุนุฏูู ูู ุฌุฏูู ุงูููุงุชูุฑ (ุตูุญุฉ ุงููุจูุนุงุช)

## ๐ ููุฎุต ุงูุชุญุฏูุซ

ุชู ุฅุถุงูุฉ ุฒุฑ **ุชุนุฏูู ุงููุงุชูุฑุฉ** ูู **ุฌุฏูู ุนุฑุถ ุงูููุงุชูุฑ** ูู ุตูุญุฉ ุงููุจูุนุงุช (`/sales`).

---

## โจ ูุง ุชู ุฅุถุงูุชู

### 1. **ุฒุฑ ุชุนุฏูู ูู ุฌุฏูู ุงูููุงุชูุฑ**
- โ ูุธูุฑ ุจุฌุงูุจ ุฒุฑ "ุนุฑุถ ุงูุชูุงุตูู" ููููุงุชูุฑ ุงููุนููุฉ ููุท (DRAFT)
- โ ุฃููููุฉ ููู ุจุฑุชูุงููุฉ ูุงุถุญุฉ
- โ ูุชุนุทู ุฃุซูุงุก ุงูุชุนุฏูู

### 2. **Modal ุชุนุฏูู ูุทุงุจู ูุดุงุดุฉ ุงููุญุงุณุจ**
- โ ุนุฑุถ ูุนูููุงุช ุงููุงุชูุฑุฉ ุงูุญุงููุฉ
- โ ุชุนุฏูู ุฑูู ุงููุงุชูุฑุฉ
- โ ุชุบููุฑ ุงูุนููู
- โ ุฑุณุงูุฉ ุชุญุฐูุฑูุฉ ูุงุถุญุฉ
- โ ุชุญุฏูุซ ููุฑู

### 3. **ุชูุงูู ูุงูู**
- โ ุงุณุชุฎุฏุงู ููุณ `useUpdateSaleMutation` ูู RTK Query
- โ ุฅุดุนุงุฑุงุช ููุญุฏุฉ
- โ ุฅุนุงุฏุฉ ุฌูุจ ุงูุจูุงูุงุช ุชููุงุฆูุงู

---

## ๐ฏ ุงููุฑู ุจูู ุงูุตูุญุชูู

| ุงูููุฒุฉ | ุดุงุดุฉ ุงููุญุงุณุจ | ุตูุญุฉ ุงููุจูุนุงุช |
|--------|--------------|---------------|
| **ุงูุบุฑุถ** | ุงุนุชูุงุฏ ูุฅุตุฏุงุฑ ุฅูุตุงูุงุช | ุฅูุดุงุก ูุฅุฏุงุฑุฉ ุงูููุงุชูุฑ |
| **ุฒุฑ ุงูุชุนุฏูู** | ูุธูุฑ ูุจู ุงูุงุนุชูุงุฏ | ูุธูุฑ ููููุงุชูุฑ ุงููุนููุฉ ููุท |
| **ุงููููุน** | ุจุฌุงูุจ ุฒุฑ "ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ" | ุจูู ุฒุฑ "ุนุฑุถ ุงูุชูุงุตูู" ูุฒุฑ "ุญุฐู" |
| **ุงูุญุงูุงุช** | DRAFT ููุท | DRAFT ููุท |
| **Modal** | ููุณ ุงูุชุตููู | ููุณ ุงูุชุตููู |

---

## ๐๏ธ ุงูุชุนุฏููุงุช ุงูุชูููุฉ

### 1. **Imports**
```typescript
// ุฅุถุงูุฉ useUpdateSaleMutation
import { 
  useGetSalesQuery, 
  useCreateSaleMutation, 
  useDeleteSaleMutation,
  useUpdateSaleMutation,  // <-- ุฌุฏูุฏ
  useGetCustomersQuery,
  useCreateCustomerMutation,
  Sale,
  Customer,
  CreateSaleRequest,
  CreateCustomerRequest
} from '@/state/salesApi';
```

### 2. **States**
```typescript
// States ููุชุนุฏูู
const [showEditModal, setShowEditModal] = useState(false);
const [saleToEdit, setSaleToEdit] = useState<Sale | null>(null);
```

### 3. **Mutation Hook**
```typescript
const [updateSale, { isLoading: isUpdating }] = useUpdateSaleMutation();
```

### 4. **Handler Functions**
```typescript
// ูุชุญ modal ุงูุชุนุฏูู
const handleEditSale = (sale: Sale) => {
  setSaleToEdit(sale);
  setShowEditModal(true);
};

// ุญูุธ ุงูุชุนุฏููุงุช
const handleEditSubmit = async (e: React.FormEvent) => {
  e.preventDefault();
  if (!saleToEdit) return;

  const formData = new FormData(e.target as HTMLFormElement);
  const customerId = formData.get('customerId') ? Number(formData.get('customerId')) : undefined;
  const invoiceNumber = formData.get('invoiceNumber') as string;

  try {
    await updateSale({
      id: saleToEdit.id,
      data: {
        customerId,
        invoiceNumber: invoiceNumber || undefined,
      }
    }).unwrap();

    notifications.custom.success('ุชู ุจูุฌุงุญ', `ุชู ุชุนุฏูู ุงููุงุชูุฑุฉ ${saleToEdit.invoiceNumber || saleToEdit.id} ุจูุฌุงุญ`);
    setShowEditModal(false);
    setSaleToEdit(null);
    refetchSales();
  } catch (err: any) {
    notifications.custom.error('ุฎุทุฃ', err?.data?.message || 'ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุนุฏูู ุงููุงุชูุฑุฉ');
  }
};
```

### 5. **ุฒุฑ ุงูุชุนุฏูู ูู ุงูุฌุฏูู**
```jsx
{sale.status === 'DRAFT' && (
  <button
    onClick={() => handleEditSale(sale)}
    className="text-orange-600 hover:text-orange-900 p-1 rounded"
    title="ุชุนุฏูู ุงููุงุชูุฑุฉ"
    disabled={isUpdating}
  >
    <svg className="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} 
        d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" />
    </svg>
  </button>
)}
```

---

## ๐จ ูุงุฌูุฉ ุงููุณุชุฎุฏู

### ุชุฑุชูุจ ุงูุฃุฒุฑุงุฑ ูู ุงูุฌุฏูู:

```
[๐จ๏ธ ุทุจุงุนุฉ] [๐๏ธ ุนุฑุถ] [โ๏ธ ุชุนุฏูู*] [๐๏ธ ุญุฐู]
```

*ูุธูุฑ ููุท ููููุงุชูุฑ ุงููุนููุฉ (DRAFT)

### Modal ุงูุชุนุฏูู:
- **ุงูุนููุงู:** ุฎูููุฉ ุจุฑุชูุงููุฉ ูุน "โ๏ธ ุชุนุฏูู ุงููุงุชูุฑุฉ"
- **ุงููุญุชูู:**
  ```
  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  โ ูุนูููุงุช ุงููุงุชูุฑุฉ ุงูุญุงููุฉ (ุฎูููุฉ ุฑูุงุฏูุฉ)โ
  โ - ุฑูู ุงููุงุชูุฑุฉ: INV-001                 โ
  โ - ุงูุนููู: ุฃุญูุฏ ูุญูุฏ                     โ
  โ - ุงููุฌููุน: 1,500.00 ุฏ.ู                โ
  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  
  ๐ ุฑูู ุงููุงุชูุฑุฉ ุงูุฌุฏูุฏ: [__________]
  ๐ก ุงุชุฑูู ูุงุฑุบุงู ููุงุญุชูุงุธ ุจุงูุฑูู ุงูุญุงูู
  
  ๐ค ุงูุนููู: [โผ ูุงุฆูุฉ ููุณุฏูุฉ]
  ๐ก ููููู ุชุบููุฑ ุงูุนููู
  
  โ๏ธ ููุงุญุธุฉ ูููุฉ:
  ูุง ูููู ุชุนุฏูู ุงูุฃุตูุงู ุฃู ุงููููุงุช ุจุนุฏ ุฅูุดุงุก ุงููุงุชูุฑุฉ.
  
  [ุฅูุบุงุก]  [ุญูุธ ุงูุชุนุฏููุงุช โ]
  ```

---

## ๐ ุงููููุฏ

### ูุธูุฑ ุฒุฑ ุงูุชุนุฏูู ููุท ุนูุฏูุง:
- โ ุญุงูุฉ ุงููุงุชูุฑุฉ = `DRAFT` (ูุนููุฉ)

### ูุง ูุธูุฑ ุฒุฑ ุงูุชุนุฏูู ุนูุฏูุง:
- โ ุญุงูุฉ ุงููุงุชูุฑุฉ = `APPROVED` (ูุนุชูุฏุฉ)
- โ ุญุงูุฉ ุงููุงุชูุฑุฉ = `CANCELLED` (ููุบูุฉ)

### ูุง ูููู ุชุนุฏููู:
- โ ุฑูู ุงููุงุชูุฑุฉ
- โ ุงูุนููู

### ูุง ูุง ูููู ุชุนุฏููู:
- โ ุงูุฃุตูุงู
- โ ุงููููุงุช
- โ ุงูุฃุณุนุงุฑ
- โ ููุน ุงูุจูุน (ููุญุฏุฏ ุนูุฏ ุงูุงุนุชูุงุฏ)

---

## ๐งช ููููุฉ ุงูุงุฎุชุจุงุฑ

### 1. **ุงุฎุชุจุงุฑ ุธููุฑ ุงูุฒุฑ:**
```bash
1. ุงูุชุญ ุตูุญุฉ ุงููุจูุนุงุช (/sales)
2. ุงุจุญุซ ุนู ูุงุชูุฑุฉ ุจุญุงูุฉ "ูุจุฏุฆูุฉ" (DRAFT)
3. ุชุญูู ูู ุธููุฑ ุฒุฑ ุงูุชุนุฏูู (ุฃููููุฉ ููู ุจุฑุชูุงููุฉ)
4. ูุง ูุฌุจ ุฃู ูุธูุฑ ููููุงุชูุฑ ุงููุนุชูุฏุฉ
```

### 2. **ุงุฎุชุจุงุฑ ุงูุชุนุฏูู:**
```bash
1. ุงููุฑ ุนูู ุฒุฑ ุงูุชุนุฏูู
2. ุบููุฑ ุฑูู ุงููุงุชูุฑุฉ
3. ุงุฎุชุฑ ุนููู ุขุฎุฑ
4. ุงููุฑ ุนูู "ุญูุธ ุงูุชุนุฏููุงุช"
5. ุชุญูู ูู ุธููุฑ ุงูุฅุดุนุงุฑ
6. ุชุญูู ูู ุงูุชุญุฏูุซ ูู ุงูุฌุฏูู
```

### 3. **ุงุฎุชุจุงุฑ ุงูุชุญุฏูุซ ุงูููุฑู:**
```bash
1. ุงูุชุญ ุตูุญุฉ ุงููุจูุนุงุช ูู ุชุจููุจูู
2. ุนุฏูู ูุงุชูุฑุฉ ูู ุงูุชุจููุจ ุงูุฃูู
3. ุชุญูู ูู ุงูุชุญุฏูุซ ูู ุงูุชุจููุจ ุงูุซุงูู
```

---

## ๐ธ ุณูุฑ ุงูุนูู

```
ูุณุชุฎุฏู ุงููุจูุนุงุช
    โ
ููุชุญ ุตูุญุฉ ุงููุจูุนุงุช (/sales)
    โ
ูุฑู ุฌุฏูู ุงูููุงุชูุฑ
    โ
ููุงุญุธ ุฎุทุฃ ูู ูุงุชูุฑุฉ ูุนููุฉ (DRAFT)
    โ
ูููุฑ ุนูู ุฒุฑ "ุชุนุฏูู" (ุฃููููุฉ ููู ุจุฑุชูุงููุฉ)
    โ
ููุชุญ Modal ุงูุชุนุฏูู
    โ
ูุนุฏู ุฑูู ุงููุงุชูุฑุฉ ุฃู ุงูุนููู
    โ
ูููุฑ ุนูู "ุญูุธ ุงูุชุนุฏููุงุช"
    โ
ุชุธูุฑ ุฑุณุงูุฉ ูุฌุงุญ
    โ
ูุชู ุงูุชุญุฏูุซ ููุฑุงู ูู ุงูุฌุฏูู
    โ
ูููู ุงูุขู ุฅุฑุณุงููุง ูููุญุงุณุจ ููุงุนุชูุงุฏ
```

---

## ๐ฏ ุงูููุงุฆุฏ

### ูููุณุชุฎุฏููู:
- โ ุชุนุฏูู ุณุฑูุน ููููุงุชูุฑ ุงููุนููุฉ
- โ ุชุตุญูุญ ุงูุฃุฎุทุงุก ูุจู ุงูุงุนุชูุงุฏ
- โ ูุงุฌูุฉ ููุญุฏุฉ ูุน ุดุงุดุฉ ุงููุญุงุณุจ

### ูููุธุงู:
- โ ูุฑููุฉ ุฃูุจุฑ ูู ุฅุฏุงุฑุฉ ุงูููุงุชูุฑ
- โ ุชูููู ุงูุญุงุฌุฉ ููุญุฐู ูุฅุนุงุฏุฉ ุงูุฅูุดุงุก
- โ ููุฏ ููุญุฏ ููุดุชุฑู

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

### Frontend:
- โ `client/src/app/sales/page.tsx`
  - ุฅุถุงูุฉ imports: `useUpdateSaleMutation`
  - ุฅุถุงูุฉ states: `showEditModal`, `saleToEdit`
  - ุฅุถุงูุฉ mutation hook: `updateSale`
  - ุฅุถุงูุฉ handlers: `handleEditSale`, `handleEditSubmit`
  - ุฅุถุงูุฉ ุฒุฑ ุงูุชุนุฏูู ูู ุงูุฌุฏูู
  - ุฅุถุงูุฉ Edit Modal

### Backend:
- โ ูู ูุชู ุชุนุฏูู Backend (API ููุฌูุฏ ูุณุจูุงู)

---

## ๐ ุงูุฑุจุท ูุน ุงูููุฒุงุช ุงูุฃุฎุฑู

### ุดุงุดุฉ ุงููุญุงุณุจ:
```
ุตูุญุฉ ุงููุจูุนุงุช โ ุชุนุฏูู ุงููุงุชูุฑุฉ โ ุดุงุดุฉ ุงููุญุงุณุจ โ ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ
```

### ุงูุชุฏูู ุงููุงูู:
```
1. ุฅูุดุงุก ูุงุชูุฑุฉ (ุตูุญุฉ ุงููุจูุนุงุช)
   โ
2. ุชุนุฏูู ุงููุงุชูุฑุฉ ุฅู ูุฒู (ุตูุญุฉ ุงููุจูุนุงุช) โฌ๏ธ ุฌุฏูุฏ!
   โ
3. ุฅุฑุณุงููุง ูููุญุงุณุจ
   โ
4. ุชุนุฏูู ููุงุฆู (ุดุงุดุฉ ุงููุญุงุณุจ)
   โ
5. ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ (ุดุงุดุฉ ุงููุญุงุณุจ)
   โ
6. ุฅุตุฏุงุฑ ุฅูุตุงู ูุจุถ (ุดุงุดุฉ ุงููุญุงุณุจ)
```

---

## โ๏ธ ููุงุญุธุงุช ูููุฉ

### 1. **ุงูุชูุงูู:**
- ููุณ ุงูู API ุงููุณุชุฎุฏู ูู ุดุงุดุฉ ุงููุญุงุณุจ
- ููุณ ุงูููุทู ูุงูุชุญูู
- ููุณ ุฑุณุงุฆู ุงูุฃุฎุทุงุก

### 2. **ุงูุฃูุงู:**
- ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ูู Backend
- ููุท ุงูููุงุชูุฑ ุงููุนููุฉ ูููู ุชุนุฏูููุง
- ุงููุณุชุฎุฏููู ุงูุนุงุฏููู ูุญุฏูุฏูู ุจุดุฑูุงุชูู

### 3. **UX:**
- ุฒุฑ ูุงุถุญ ูุน ุฃููููุฉ ูููุฒุฉ
- ูุธูุฑ ููุท ุนูุฏ ุงูุญุงุฌุฉ
- Modal ูุชุณู ูุน ุจุงูู ุงููุธุงู

---

## โ ุงูุฎูุงุตุฉ

ุชู ุจูุฌุงุญ ุฅุถุงูุฉ **ุฒุฑ ุงูุชุนุฏูู ูู ุฌุฏูู ุงูููุงุชูุฑ** ูู ุตูุญุฉ ุงููุจูุนุงุช:

1. โ ุฒุฑ ุชุนุฏูู ูุธูุฑ ููููุงุชูุฑ ุงููุนููุฉ ููุท
2. โ Modal ุชุนุฏูู ุงุญุชุฑุงูู ูุทุงุจู ูุดุงุดุฉ ุงููุญุงุณุจ
3. โ ุชูุงูู ูุงูู ูุน API ููุฌูุฏ
4. โ ุชุญุฏูุซ ููุฑู ูู ุงููุงุฌูุฉ
5. โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุชุณูุฉ

**ุงูููุฒุฉ ุฌุงูุฒุฉ ููุงุณุชุฎุฏุงู! ๐**

---

**ุชุงุฑูุฎ ุงูุฅุถุงูุฉ:** 2025-11-04  
**ุงูุฅุตุฏุงุฑ:** 1.1.0  
**ุงูุญุงูุฉ:** โ ุฌุงูุฒ ููุฅูุชุงุฌ  
**ูุฑุชุจุท ุจู:** `SALES_EDIT_FEATURE.md`

