# ุฅุตูุงุญ: ุฅุธูุงุฑ ุฃุฒุฑุงุฑ ุงููุจุถ ุฏุงุฆูุงู (ุญู ุงููุดููุฉ ุงูููุงุฆู)

## ๐ด ุงููุดููุฉ

**ูุง ุฃุจูุบ ุนูู ุงููุณุชุฎุฏู:**
> "ุงูุฃุฒุฑุงุฑ ุงูุฌุฏูุฏุฉ (ูุจุถ ูุจูุบุ ุฅูุตุงูุงุช ุงููุจุถ) ูู ุชุธูุฑ ูู ุงูุดุงุดุฉ"

### **ุงูุณุจุจ ุงูุฌุฐุฑู:**

```typescript
// ูุจู ุงูุฅุตูุงุญ (ุงูุณุทุฑ 1017)
{sale.status === 'DRAFT' ? (
  // ุฒุฑ "ุฃูุฑ ุตุฑู ุงููุฎุฒู" ููุท โ
) : (
  // ุฃุฒุฑุงุฑ ุงููุจุถ ูุงูุฅูุตุงูุงุช โ
)}
```

**ุงููุดููุฉ:**
- ุฌููุน ุงูููุงุชูุฑ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูุช `status: "DRAFT"`
- ุงูุฃุฒุฑุงุฑ ูุงูุช ูุฎููุฉ ููููุงุชูุฑ ุงููุจุฏุฆูุฉ
- ุงููุณุชุฎุฏู ูุงู ูุญุชุงุฌ ุฃู ูููุฑ ุนูู "ุฃูุฑ ุตุฑู ุงููุฎุฒู" ุฃููุงู ูุชุธูุฑ ุงูุฃุฒุฑุงุฑ
- ูุฐุง ูุฑุจู ูุบูุฑ ูุงุถุญ!

---

## โ ุงูุญู

### **ุฅุฒุงูุฉ ุงูุดุฑุท ูุฅุธูุงุฑ ุงูุฃุฒุฑุงุฑ ุฏุงุฆูุงู**

```typescript
// ุจุนุฏ ุงูุฅุตูุงุญ (ุงูุณุทุฑ 1036-1144)
<td className="px-6 py-4 whitespace-nowrap text-sm">
  <div className="flex items-center gap-2 flex-wrap">
    {/* ุฒุฑ ูุจุถ ูุจูุบ - ูุธูุฑ ุฏุงุฆูุงู */}
    {(sale.remainingAmount || 0) > 0 && (
      <button onClick={async () => {
        // ุฅุฐุง ูุงูุช DRAFTุ ุงุนุชูุฏูุง ุฃููุงู
        if (sale.status === 'DRAFT') {
          await approveSale({ ... });
          await refetch();
          success('ุชู ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุจูุฌุงุญ');
          setTimeout(() => {
            setSelectedCreditSale(sale);
            setShowPaymentModal(true);
          }, 500);
        } else {
          // ูุนุชูุฏุฉ ุจุงููุนู - ุงูุชุญ modal ูุจุงุดุฑุฉ
          setSelectedCreditSale(sale);
          setShowPaymentModal(true);
        }
      }}>
        ูุจุถ ูุจูุบ
      </button>
    )}
    
    {/* ุจููุฉ ุงูุฃุฒุฑุงุฑ... */}
  </div>
</td>
```

---

## ๐ฏ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ

### **1. ุฒุฑ "ูุจุถ ูุจูุบ" ูุธูุฑ ุฏุงุฆูุงู** ๐ข

#### **ุงูุดุฑุท ุงููุญูุฏ:**
```typescript
{(sale.remainingAmount || 0) > 0}
```

- โ ูุธูุฑ ููููุงุชูุฑ DRAFT
- โ ูุธูุฑ ููููุงุชูุฑ APPROVED
- โ ูุฎุชูู ููุท ุฅุฐุง `remainingAmount = 0` (ูุฏููุน ุจุงููุงูู)

#### **ุงูุณููู ุนูุฏ ุงูููุฑ:**

**ููููุงุชูุฑ DRAFT:**
```
1. ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุชููุงุฆูุงู (DRAFT โ APPROVED)
2. ุชุญุฏูุซ ุงูุจูุงูุงุช
3. ุฑุณุงูุฉ ูุฌุงุญ: "ุชู ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุจูุฌุงุญ"
4. ูุชุญ modal ุงููุจุถ ุจุนุฏ 500ms
```

**ููููุงุชูุฑ APPROVED:**
```
1. ูุชุญ modal ุงููุจุถ ูุจุงุดุฑุฉ
```

---

### **2. ุฒุฑ "ุฅูุตุงูุงุช ุงููุจุถ" ูุธูุฑ ุนูุฏ ูุฌูุฏ ุฅูุตุงูุงุช** ๐ฃ

```typescript
{sale.payments && sale.payments.length > 0}
```

- โ ูุธูุฑ ููููุงุชูุฑ DRAFT (ุฅุฐุง ูุงูุช ููุง ุฅูุตุงูุงุช)
- โ ูุธูุฑ ููููุงุชูุฑ APPROVED (ุฅุฐุง ูุงูุช ููุง ุฅูุตุงูุงุช)

---

### **3. ุฒุฑ "ุฃูุฑ ุตุฑู ุงููุฎุฒู"** ๐

```typescript
{sale.dispatchOrders && sale.dispatchOrders.length > 0 ? (
  // ุชู ุงูุตุฑู (ูุนุทู)
) : (
  // ุฃูุฑ ุตุฑู
)}
```

- โ ูุธูุฑ ุฏุงุฆูุงู
- โ ูุชุบูุฑ ูู "ุชู ุงูุตุฑู" (ูุนุทู) ุจุนุฏ ุฅูุดุงุก ุฃูุฑ ุงูุตุฑู

---

### **4. ุฃุฒุฑุงุฑ ุงูุทุจุงุนุฉ ูุงููุงุชุณุงุจ** ๐จ๏ธ๐ฌ

```typescript
<button onClick={() => printReceipt(sale)}>ุทุจุงุนุฉ</button>
<button onClick={() => handleSendWhatsApp(sale)}>ูุงุชุณุงุจ</button>
```

- โ ุชุธูุฑ ุฏุงุฆูุงู ูุฌููุน ุงูููุงุชูุฑ

---

## ๐ ุงูุชุฏูู ุงููุงูู

### **ุงูุณููุงุฑูู 1: ูุจุถ ูุจูุบ ูู ูุงุชูุฑุฉ ูุจุฏุฆูุฉ (DRAFT)**

```
1๏ธโฃ ุงููุณุชุฎุฏู ููุชุญ ุดุงุดุฉ ุงููุญุงุณุจ
   - ูุฑู ูุงุชูุฑุฉ:
     * status: DRAFT
     * remainingAmount: 10,000 ุฑ.ุณ
   
   - ุงูุฃุฒุฑุงุฑ ุงููุนุฑูุถุฉ:
     ๐ข [ูุจุถ ูุจูุบ]
     ๐ [ุฃูุฑ ุตุฑู]
     ๐จ๏ธ [ุทุจุงุนุฉ]
     ๐ฌ [ูุงุชุณุงุจ]
   
   โ
   
2๏ธโฃ ูููุฑ ุนูู "ูุจุถ ูุจูุบ" ๐ข
   
   โ
   
3๏ธโฃ ุงููุธุงู ูููู ุชููุงุฆูุงู:
   โ ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ (DRAFT โ APPROVED)
   โ ุชุญุฏูุซ saleType: CREDIT
   โ ุชุญุฏูุซ remainingAmount: 10,000
   โ ุฎุตู ุงููุฎุฒูู
   โ refetch ุงูุจูุงูุงุช
   
   ๐ข ุฑุณุงูุฉ ูุฌุงุญ: "ุชู ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุจูุฌุงุญ"
   
   โ ุจุนุฏ 500ms
   
4๏ธโฃ ููุชุญ modal ุงููุจุถ:
   - ูุนูููุงุช ุงููุงุชูุฑุฉ
   - ุตุงูู ุงููุงุชูุฑุฉ: 10,000
   - ุงููุฏููุน ุณุงุจูุงู: 0
   - ุงููุชุจูู: 10,000 (ุจุงุฑุฒ)
   
   โ
   
5๏ธโฃ ููุฏุฎู ุงููุจูุบ (ูุซูุงู: 5,000 ุฑ.ุณ)
   - ุทุฑููุฉ ุงูุฏูุน: ูุงุด
   - ููุงุญุธุงุช: ุฏูุนุฉ ุฃููู
   
   โ
   
6๏ธโฃ ูููุฑ "ุชุฃููุฏ ูุฅุตุฏุงุฑ ุฅูุตุงู"
   
   โ
   
7๏ธโฃ ุงููุชูุฌุฉ:
   โ ุชู ุญูุธ ุงูุฏูุนุฉ
   โ ุชุญุฏูุซ:
      - paidAmount: 5,000
      - remainingAmount: 5,000
   โ ุฅุตุฏุงุฑ ุฅูุตุงู ูุจุถ #REC-001
   โ ูุชุญ modal ุงูุทุจุงุนุฉ ุชููุงุฆูุงู
   
   โ
   
8๏ธโฃ ุงูุขู ูู ุงูุฌุฏูู:
   - ุงููุฏููุน: 5,000 ุฑ.ุณ (ุฃุฎุถุฑ)
   - ุงููุชุจูู: 5,000 ุฑ.ุณ (ุจุฑุชูุงูู)
   
   - ุงูุฃุฒุฑุงุฑ ุงููุนุฑูุถุฉ:
     ๐ข [ูุจุถ ูุจูุบ] โ ูุง ูุฒุงู ููุฌูุฏุงู
     ๐ฃ [ุฅูุตุงูุงุช ุงููุจุถ (1)] โ ุธูุฑ ุฒุฑ ุฌุฏูุฏ!
     ๐ [ุชู ุงูุตุฑู] โ ูุนุทู
     ๐จ๏ธ [ุทุจุงุนุฉ]
     ๐ฌ [ูุงุชุณุงุจ]
```

---

### **ุงูุณููุงุฑูู 2: ูุจุถ ูุจูุบ ูู ูุงุชูุฑุฉ ูุนุชูุฏุฉ (APPROVED)**

```
1๏ธโฃ ุงููุงุชูุฑุฉ ูุนุชูุฏุฉ ุจุงููุนู:
   - status: APPROVED
   - remainingAmount: 7,000 ุฑ.ุณ
   
   โ
   
2๏ธโฃ ูููุฑ ุนูู "ูุจุถ ูุจูุบ" ๐ข
   
   โ
   
3๏ธโฃ ููุชุญ modal ุงููุจุถ ูุจุงุดุฑุฉ (ุจุฏูู ุงุนุชูุงุฏ)
   
   โ
   
4๏ธโฃ ููุฏุฎู ุงููุจูุบ ููุคูุฏ
   
   โ
   
5๏ธโฃ ุชุชู ุงูุนูููุฉ ุจูุฌุงุญ
```

---

## ๐ ููุงุฑูุฉ: ูุจู ูุจุนุฏ

### **ูุจู ุงูุฅุตูุงุญ:**

| ุญุงูุฉ ุงููุงุชูุฑุฉ | ุงูุฃุฒุฑุงุฑ ุงููุนุฑูุถุฉ |
|---------------|------------------|
| **DRAFT** | ๐ [ุฃูุฑ ุตุฑู ุงููุฎุฒู] ููุท |
| **APPROVED** | ๐ข [ูุจุถ ูุจูุบ] + ๐ฃ [ุฅูุตุงูุงุช] + ๐ [ุฃูุฑ ุตุฑู] + ... |

**ุงููุดููุฉ:**
- โ ุงููุณุชุฎุฏู ูุง ูุนุฑู ุฃู ุนููู ุงูููุฑ ุนูู "ุฃูุฑ ุตุฑู ุงููุฎุฒู" ุฃููุงู
- โ ุฎุทูุฉ ุฅุถุงููุฉ ุบูุฑ ุถุฑูุฑูุฉ
- โ ูุฑุจู ูููุณุชุฎุฏู

---

### **ุจุนุฏ ุงูุฅุตูุงุญ:**

| ุญุงูุฉ ุงููุงุชูุฑุฉ | ุงูุฃุฒุฑุงุฑ ุงููุนุฑูุถุฉ |
|---------------|------------------|
| **DRAFT** | ๐ข [ูุจุถ ูุจูุบ] + ๐ [ุฃูุฑ ุตุฑู] + ๐จ๏ธ [ุทุจุงุนุฉ] + ๐ฌ [ูุงุชุณุงุจ] |
| **APPROVED** | ๐ข [ูุจุถ ูุจูุบ] + ๐ฃ [ุฅูุตุงูุงุช] + ๐ [ุฃูุฑ ุตุฑู] + ๐จ๏ธ + ๐ฌ |

**ุงููููุฒุงุช:**
- โ ุฒุฑ "ูุจุถ ูุจูุบ" ูุงุถุญ ููุชุงุญ ุฏุงุฆูุงู
- โ ุงูููุฑ ุนููู ูุนุชูุฏ ุงููุงุชูุฑุฉ ุชููุงุฆูุงู ุฅุฐุง ูุงูุช DRAFT
- โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ
- โ ุฎุทูุฉ ูุงุญุฏุฉ ุจุฏูุงู ูู ุฎุทูุชูู

---

## ๐ง ุงูุชูุงุตูู ุงูุชูููุฉ

### **ุงูููู:** `client/src/app/accountant/page.tsx`

#### **1. ุฅุฒุงูุฉ ุงูุดุฑุท (ุงูุณุทุฑ 1035-1036)**

```typescript
// ูุจู
{sale.status === 'DRAFT' ? (
  // ุฃุฒุฑุงุฑ DRAFT ููุท
) : (
  // ุฃุฒุฑุงุฑ APPROVED ููุท
)}

// ุจุนุฏ
<div className="flex items-center gap-2 flex-wrap">
  {/* ุฌููุน ุงูุฃุฒุฑุงุฑ ุจุฏูู ุดุฑุท */}
</div>
```

---

#### **2. ุชุญุฏูุซ ุฒุฑ "ูุจุถ ูุจูุบ" (ุงูุณุทุฑ 1038-1077)**

```typescript
{(sale.remainingAmount || 0) > 0 && (
  <button onClick={async () => {
    if (sale.status === 'DRAFT') {
      // ุงุนุชูุงุฏ ุชููุงุฆู
      await approveSale({
        id: sale.id,
        saleType: 'CREDIT',
        paymentMethod: undefined
      }).unwrap();
      
      // ุชุญุฏูุซ ุงูุจูุงูุงุช
      await Promise.all([
        refetch(),
        refetchPending(),
        refetchIssued()
      ]);
      
      success('ุชู ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุจูุฌุงุญ');
      
      // ูุชุญ modal ุจุนุฏ 500ms
      setTimeout(() => {
        setSelectedCreditSale(sale);
        setShowPaymentModal(true);
      }, 500);
    } else {
      // ูุชุญ modal ูุจุงุดุฑุฉ
      setSelectedCreditSale(sale);
      setShowPaymentModal(true);
    }
  }}
  title={sale.status === 'DRAFT' ? 
    'ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ููุจุถ ูุจูุบ' : 
    'ูุจุถ ูุจูุบ ูู ุงูุนููู'
  }>
    ูุจุถ ูุจูุบ
  </button>
)}
```

---

#### **3. ุฅุถุงูุฉ ุฒุฑ ูุงุชุณุงุจ (ุงูุณุทุฑ 1133-1143)**

```typescript
<button
  onClick={() => handleSendWhatsApp(sale)}
  className="... bg-green-600 ..."
>
  <svg>ูุงุชุณุงุจ</svg>
  ูุงุชุณุงุจ
</button>
```

---

## โ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### **ุงูุขู ุนูุฏ ูุชุญ ุดุงุดุฉ ุงููุญุงุณุจ:**

```
๐ ุงูููุงุชูุฑ:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ ูุงุชูุฑุฉ #INV-001 | ุงูุชูุงุฒู | 10,000 ุฑ.ุณ | 0 | 10,000    โ
โ [ูุจุถ ูุจูุบ๐ข] [ุฃูุฑ ุตุฑู๐] [ุทุจุงุนุฉ๐จ๏ธ] [ูุงุชุณุงุจ๐ฌ]          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ ุฒุฑ "ูุจุถ ูุจูุบ" ุธุงูุฑ ููุชุงุญ!
โ ุงูููุฑ ุนููู ูุนุชูุฏ ุงููุงุชูุฑุฉ ูููุชุญ modal ุงููุจุถ
โ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุณูุณุฉ ูุจุณูุทุฉ
```

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

```
โ client/src/app/accountant/page.tsx
   - ุงูุณุทุฑ 1035-1144: ุฅุนุงุฏุฉ ููููุฉ ุงูุฃุฒุฑุงุฑ
   - ุฅุฒุงูุฉ ุงูุดุฑุท ุนูู sale.status
   - ุฅุถุงูุฉ ููุทู ุงุนุชูุงุฏ ุชููุงุฆู ูู ุฒุฑ "ูุจุถ ูุจูุบ"
   - ุฅุถุงูุฉ ุฒุฑ ูุงุชุณุงุจ
```

---

## ๐งช ุงูุงุฎุชุจุงุฑ

### **1. ุงูุชุญ ุดุงุดุฉ ุงููุญุงุณุจ**
```
http://localhost:3030/accountant
```

### **2. ุชุญูู ูู ุงูุฃุฒุฑุงุฑ**
- โ ูุฌุจ ุฃู ุชุฑู ุฒุฑ "ูุจุถ ูุจูุบ" ๐ข ูุฌููุน ุงูููุงุชูุฑ
- โ ูุฌุจ ุฃู ุชุฑู ุจุงูู ุงูุฃุฒุฑุงุฑ (ุฃูุฑ ุตุฑูุ ุทุจุงุนุฉุ ูุงุชุณุงุจ)

### **3. ุงููุฑ ุนูู "ูุจุถ ูุจูุบ"**
- โ ุฅุฐุง ูุงูุช ุงููุงุชูุฑุฉ DRAFT:
  - ุฑุณุงูุฉ: "ุชู ุงุนุชูุงุฏ ุงููุงุชูุฑุฉ ุจูุฌุงุญ"
  - ุซู ููุชุญ modal ุงููุจุถ
- โ ุฅุฐุง ูุงูุช ูุนุชูุฏุฉ:
  - ููุชุญ modal ูุจุงุดุฑุฉ

### **4. ุฃููู ุนูููุฉ ุงููุจุถ**
- โ ุฃุฏุฎู ุงููุจูุบ
- โ ุงุฎุชุฑ ุทุฑููุฉ ุงูุฏูุน
- โ ุงููุฑ "ุชุฃููุฏ"
- โ ููุตุฏุฑ ุฅูุตุงู
- โ ูุธูุฑ ุฒุฑ "ุฅูุตุงูุงุช ุงููุจุถ (1)" ๐ฃ

---

## ๐ก ุงูุฎูุงุตุฉ

| ูุจู | ุจุนุฏ |
|-----|-----|
| โ ุฃุฒุฑุงุฑ ุงููุจุถ ูุฎููุฉ ููู DRAFT | โ ุฃุฒุฑุงุฑ ุงููุจุถ ุชุธูุฑ ุฏุงุฆูุงู |
| โ ุงููุณุชุฎุฏู ูุง ูุนุฑู ูุงุฐุง ููุนู | โ ุฒุฑ "ูุจุถ ูุจูุบ" ูุงุถุญ ููุจุงุดุฑ |
| โ ุฎุทูุชูู (ุฃูุฑ ุตุฑู โ ูุจุถ) | โ ุฎุทูุฉ ูุงุญุฏุฉ (ูุจุถ ูุจุงุดุฑุฉ) |
| โ ูุฑุจู | โ ุณูุณ ูุจุณูุท |

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 5 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ุชู ุงูุฅุตูุงุญ ูุงูุงุฎุชุจุงุฑ  
**ุงูุชุฃุซูุฑ:** ๐ ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู ุจูุซูุฑ!


