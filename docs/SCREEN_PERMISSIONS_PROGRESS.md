# ุชูุฑูุฑ ุงูุชูุฏู: ูุธุงู ุงูุตูุงุญูุงุช ุงููุจูู ุนูู ุงูุดุงุดุงุช

## โ ูุง ุชู ุฅูุฌุงุฒู

### 1. Backend Development (ููุชูู 100%)

#### Constants & Types
- โ **screenPermissions.ts**: ุชุนุฑูู ุฌููุน ุงูุตูุงุญูุงุช ูุงูุดุงุดุงุช
  - 16 ุดุงุดุฉ ูุนุฑููุฉ ูุน ูุนูููุงุช ูุงููุฉ
  - ุฏูุงู ูุณุงุนุฏุฉ ููุชุญูู ูู ุงูุตูุงุญูุงุช
  - ุชุฌููุน ุงูุดุงุดุงุช ุญุณุจ ุงููุฆุงุช (6 ูุฆุงุช)

#### Middleware
- โ **screenAuthorization.ts**: middleware ููุชุญูู ูู ุตูุงุญูุงุช ุงูุดุงุดุงุช
  - `authorizeScreen`: ุงูุชุญูู ูู ุตูุงุญูุฉ ุดุงุดุฉ ูุงุญุฏุฉ
  - `authorizeAnyScreen`: ุงูุชุญูู ูู ุฃู ุตูุงุญูุฉ ูู ูุงุฆูุฉ
  - `authorizeAllScreens`: ุงูุชุญูู ูู ุฌููุน ุงูุตูุงุญูุงุช

#### Controllers
- โ **screensController.ts**: endpoints ููุดุงุดุงุช
  - `getAllScreens`: ุฌูุจ ุฌููุน ุงูุดุงุดุงุช ุงููุชุงุญุฉ
  - `getUserScreens`: ุฌูุจ ุงูุดุงุดุงุช ุงููุตุฑุญ ุจูุง ูููุณุชุฎุฏู
  - `getScreensByCategory`: ุฌูุจ ุงูุดุงุดุงุช ุญุณุจ ุงููุฆุฉ

#### Routes
- โ **screensRoute.ts**: ุชุณุฌูู ุฌููุน ุงููุณุงุฑุงุช
  - GET `/api/screens` - ุฌููุน ุงูุดุงุดุงุช
  - GET `/api/users/me/screens` - ุดุงุดุงุช ุงููุณุชุฎุฏู
  - GET `/api/screens/category/:category` - ุดุงุดุงุช ุญุณุจ ุงููุฆุฉ

#### Server Integration
- โ **index.ts**: ุชุณุฌูู routes ูู ุงูุชุทุจูู
  - Import screensRoute
  - Register: `app.use('/api', screensRoute)`

#### Seed Data
- โ **UserRoles.json**: ุชุญุฏูุซ ุงูุฃุฏูุงุฑ ุจุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ
  - Admin: `screen.all`
  - Manager: 13 ุดุงุดุฉ
  - Cashier: 6 ุดุงุดุงุช
  - Accountant: 6 ุดุงุดุงุช
  - Warehouse: 5 ุดุงุดุงุช (ุฏูุฑ ุฌุฏูุฏ)

### 2. Frontend Development (ููุชูู 100%)

#### Types
- โ **permissions.ts**: ุชุนุฑูู ุงูุฃููุงุน ูุงูุฏูุงู ุงููุณุงุนุฏุฉ
  - `ScreenPermission` interface
  - `UserScreensResponse` interface
  - `hasScreenAccess()` function
  - `getScreenByRoute()` function
  - `groupScreensByCategory()` function

#### API Integration
- โ **permissionsApi.ts**: RTK Query endpoints
  - `useGetAllScreensQuery`: ุฌูุจ ุฌููุน ุงูุดุงุดุงุช
  - `useGetUserScreensQuery`: ุฌูุจ ุดุงุดุงุช ุงููุณุชุฎุฏู
  - `useGetScreensByCategoryQuery`: ุฌูุจ ุดุงุดุงุช ุญุณุจ ุงููุฆุฉ
  - Cache tags: `Screens`, `UserScreens`
  - Transform responses ููุญุตูู ุนูู ุงูุจูุงูุงุช ูุจุงุดุฑุฉ

#### Sidebar Integration
- โ **Sidebar/index.tsx**: ุชุทุจูู ูุธุงู ุงูุตูุงุญูุงุช
  - ุงุณุชุฎุฏุงู `useGetUserScreensQuery()`
  - ุฏุงูุฉ `canAccessScreen(route)` ููุชุญูู
  - ุฅุฎูุงุก ุงูุฑูุงุจุท ุบูุฑ ุงููุตุฑุญ ุจูุง
  - ุงูุญูุงุธ ุนูู ููุทู ุงูุดุฑูุฉ ุงูุฃู

### 3. Documentation (ููุชูู 100%)

- โ **PERMISSIONS_SYSTEM_PLAN.md**: ุฎุทุฉ ุดุงููุฉ ูููุธุงู
  - ุงููุถุน ุงูุญุงูู ูุงููุทููุจ
  - ูููู ุงูุตูุงุญูุงุช ุงูุฌุฏูุฏ
  - ุฎุทูุงุช ุงูุชูููุฐ ุงูุชูุตูููุฉ
  - ุฃูุซูุฉ ูุญุงูุงุช ุงุณุชุฎุฏุงู

## ๐ ุงููููุงุช ุงูููุดุฃุฉ/ุงููุนุฏูุฉ

### Backend Files:
```
โ server/src/constants/screenPermissions.ts (ุฌุฏูุฏ)
โ server/src/middleware/screenAuthorization.ts (ุฌุฏูุฏ)
โ server/src/controllers/screensController.ts (ุฌุฏูุฏ)
โ server/src/routes/screensRoute.ts (ุฌุฏูุฏ)
โ server/src/index.ts (ูุนุฏู)
โ server/prisma/seedData/UserRoles.json (ูุนุฏู)
```

### Frontend Files:
```
โ client/src/types/permissions.ts (ุฌุฏูุฏ)
โ client/src/state/permissionsApi.ts (ูุนุฏู)
โ client/src/app/(components)/Sidebar/index.tsx (ูุนุฏู)
```

### Documentation:
```
โ PERMISSIONS_SYSTEM_PLAN.md (ุฌุฏูุฏ)
โ SCREEN_PERMISSIONS_PROGRESS.md (ูุฐุง ุงูููู)
```

## ๐ฏ ุงูุดุงุดุงุช ุงููุนุฑููุฉ (16 ุดุงุดุฉ)

### ุงูุฅุฏุงุฑุฉ ุงูุฃุณุงุณูุฉ (Main):
1. โ ุงูุฑุฆูุณูุฉ - `/dashboard`
2. โ ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช - `/companies`

### ุงููุฎุฒูู (Inventory):
3. โ ุงูุฃุตูุงู ูุงููุฎุฒู - `/products`
4. โ ุฃูุงูุฑ ุตุฑู ุงููุฎุฒู - `/warehouse-dispatch`
5. โ ูุญุงุถุฑ ุงูุฅุชูุงู - `/damage-reports`

### ุงููุจูุนุงุช (Sales):
6. โ ุงููุจูุนุงุช - `/sales`
7. โ ุงููุฑุฏูุฏุงุช - `/sale-returns`
8. โ ุงููุจูุนุงุช ูู ุงูุดุฑูุฉ ุงูุฃู - `/complex-inter-company-sales`

### ุงููุดุชุฑูุงุช (Purchases):
9. โ ุงููุดุชุฑูุงุช - `/purchases`
10. โ ุฅูุตุงูุงุช ุงูุฏูุน - `/payment-receipts`

### ุงููุญุงุณุจุฉ (Accounting):
11. โ ูุณุงุญุฉ ุนูู ุงููุญุงุณุจ - `/accountant`
12. โ ุญุณุงุจุงุช ุงูุนููุงุก - `/customer-accounts`
13. โ ุญุณุงุจุงุช ุงูููุฑุฏูู - `/supplier-accounts`

### ุงูุชูุงุฑูุฑ (Reports):
14. โ ุงูุชูุงุฑูุฑ - `/reports`

### ุงูุฅุนุฏุงุฏุงุช (Settings):
15. โ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู - `/users`
16. โ ุงูุฅุดุนุงุฑุงุช - `/notifications`

## ๐ ูุง ุชุจูู ููุฅูุฌุงุฒ

### 1. Database Migration (ุนุงูู ุงูุฃููููุฉ)
```bash
# ุชุดุบูู seed ูุชุญุฏูุซ ุงูุฃุฏูุงุฑ
cd server
npm run seed
# ุฃู
npx prisma db seed
```

**ุงููุฏู**: ุชุญุฏูุซ ุฌุฏูู `UserRoles` ุจุงูุตูุงุญูุงุช ุงูุฌุฏูุฏุฉ

### 2. ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู (ูุชูุณุท ุงูุฃููููุฉ)

**ุงููุทููุจ**:
- โ ุนุฑุถ ุฌููุน ุงูุดุงุดุงุช ุงููุชุงุญุฉ (ุจุงุณุชุฎุฏุงู `useGetAllScreensQuery`)
- โ ุชุฌููุน ุงูุดุงุดุงุช ุญุณุจ ุงููุฆุงุช
- โ Checkboxes ูุงุฎุชูุงุฑ ุงูุดุงุดุงุช
- โ ุญูุธ ุงูุตูุงุญูุงุช ุนูุฏ ุฅูุดุงุก/ุชุนุฏูู ุงููุณุชุฎุฏู

**ุงููููุงุช ุงููุทููุจ ุชุนุฏูููุง**:
- `client/src/app/users/page.tsx`
- ุฅุถุงูุฉ ูููู `UserPermissionsForm.tsx` (ุงุฎุชูุงุฑู)

### 3. Route Guard Component (ูุชูุณุท ุงูุฃููููุฉ)

**ุงููุทููุจ**:
- โ ูููู `ProtectedRoute` ููุญูุงูุฉ
- โ ุงูุชุญูู ูู ุตูุงุญูุฉ ุงููุตูู ูููุณุงุฑ
- โ ุฅุนุงุฏุฉ ุงูุชูุฌูู ูุตูุญุฉ Unauthorized

**ุงูููู ุงููุทููุจ**:
```typescript
// client/src/components/ProtectedRoute.tsx
'use client';

import { useGetUserScreensQuery } from "@/state/permissionsApi";
import { usePathname, useRouter } from "next/navigation";
import { useEffect } from "react";

export const ProtectedRoute = ({ children }: { children: React.ReactNode }) => {
  const pathname = usePathname();
  const router = useRouter();
  const { data: userScreensData, isLoading } = useGetUserScreensQuery();
  
  useEffect(() => {
    if (!isLoading && userScreensData) {
      const authorizedScreens = userScreensData.screens || [];
      const hasAccess = authorizedScreens.some(screen => screen.route === pathname);
      
      if (!hasAccess && pathname !== '/unauthorized') {
        router.push('/unauthorized');
      }
    }
  }, [pathname, userScreensData, isLoading, router]);
  
  if (isLoading) {
    return <div className="flex items-center justify-center h-screen">
      <div className="text-lg">ุฌุงุฑู ุงูุชุญููู...</div>
    </div>;
  }
  
  return <>{children}</>;
};
```

**ุตูุญุฉ Unauthorized**:
```typescript
// client/src/app/unauthorized/page.tsx
export default function UnauthorizedPage() {
  return (
    <div className="flex flex-col items-center justify-center h-screen">
      <h1 className="text-4xl font-bold text-red-600 mb-4">โ ุบูุฑ ูุตุฑุญ</h1>
      <p className="text-lg text-gray-600 mb-8">ููุณ ูุฏูู ุตูุงุญูุฉ ุงููุตูู ููุฐู ุงูุตูุญุฉ</p>
      <a href="/dashboard" className="px-6 py-3 bg-blue-600 text-white rounded-lg">
        ุงูุนูุฏุฉ ููุฑุฆูุณูุฉ
      </a>
    </div>
  );
}
```

### 4. ุงูุงุฎุชุจุงุฑ (ุนุงูู ุงูุฃููููุฉ)

**ุณููุงุฑูููุงุช ุงูุงุฎุชุจุงุฑ**:

#### ุงุฎุชุจุงุฑ 1: ุงููุฏูุฑ (Admin)
- โ ูุฌุจ ุฃู ูุฑู ุฌููุน ุงูุดุงุดุงุช ูู Sidebar
- โ ููููู ุงููุตูู ูุฌููุน ุงูุตูุญุงุช

#### ุงุฎุชุจุงุฑ 2: ุงูุตุฑุงู (Cashier)
- โ ูุฑู ููุท: ุงูุฑุฆูุณูุฉุ ุงููุจูุนุงุชุ ุงููุฑุฏูุฏุงุชุ ุงููุดุชุฑูุงุชุ ุญุณุงุจุงุช ุงูุนููุงุกุ ุญุณุงุจุงุช ุงูููุฑุฏูู
- โ ูุง ูุฑู: ุฅุฏุงุฑุฉ ุงูุดุฑูุงุชุ ุงูุฃุตูุงูุ ุงูุชูุงุฑูุฑุ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
- โ ูุญุงููุฉ ุงููุตูู ูุตูุญุฉ ุบูุฑ ูุตุฑุญ ุจูุง โ Redirect to Unauthorized

#### ุงุฎุชุจุงุฑ 3: ุงููุญุงุณุจ (Accountant)
- โ ูุฑู ููุท: ุงูุฑุฆูุณูุฉุ ูุณุงุญุฉ ุงููุญุงุณุจุ ุญุณุงุจุงุช ุงูุนููุงุกุ ุญุณุงุจุงุช ุงูููุฑุฏููุ ุงูุชูุงุฑูุฑุ ุฅูุตุงูุงุช ุงูุฏูุน
- โ ูุง ูุฑู: ุงููุจูุนุงุชุ ุงููุดุชุฑูุงุชุ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู

#### ุงุฎุชุจุงุฑ 4: ุฃููู ุงููุฎุฒู (Warehouse)
- โ ูุฑู ููุท: ุงูุฑุฆูุณูุฉุ ุงูุฃุตูุงูุ ุฃูุงูุฑ ุตุฑู ุงููุฎุฒูุ ูุญุงุถุฑ ุงูุฅุชูุงูุ ุงููุดุชุฑูุงุช
- โ ูุง ูุฑู: ุงููุจูุนุงุชุ ุงูุชูุงุฑูุฑุ ุงููุญุงุณุจุฉ

## ๐จ ูููุฒุงุช ุงููุธุงู ุงูุฌุฏูุฏ

### 1. ูุฑููุฉ ุนุงููุฉ
- โ ุฅุถุงูุฉ ุดุงุดุงุช ุฌุฏูุฏุฉ ุจุณูููุฉ
- โ ุชุฎุตูุต ุงูุตูุงุญูุงุช ููู ูุณุชุฎุฏู
- โ ุชุฌููุน ุงูุดุงุดุงุช ุญุณุจ ุงููุฆุงุช

### 2. ุฃูุงู ูุญุณูู
- โ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช ุนูู ูุณุชูู Backend
- โ ุฅุฎูุงุก ุงูุดุงุดุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง ูู Sidebar
- โ ููุน ุงููุตูู ุงููุจุงุดุฑ ููุตูุญุงุช

### 3. ุชุฌุฑุจุฉ ูุณุชุฎุฏู ุฃูุถู
- โ ูุงุฌูุฉ ูุธููุฉ (ููุท ุงูุดุงุดุงุช ุงููุตุฑุญ ุจูุง)
- โ ูุง ุชูุฌุฏ ุฑูุงุจุท ุบูุฑ ูุงุจูุฉ ููุงุณุชุฎุฏุงู
- โ ุฑุณุงุฆู ูุงุถุญุฉ ุนูุฏ ุนุฏู ูุฌูุฏ ุตูุงุญูุฉ

### 4. ุณูููุฉ ุงูุตูุงูุฉ
- โ ููุฏ ููุธู ููุฑูุฒู
- โ Constants ูุดุชุฑูุฉ ุจูู Backend ู Frontend
- โ ุณูููุฉ ุฅุถุงูุฉ ุดุงุดุงุช ุฌุฏูุฏุฉ

## ๐ ุงูุฅุญุตุงุฆูุงุช

### ุงูููุฏ ุงูููุชูุจ:
- **Backend**: ~500 ุณุทุฑ
- **Frontend**: ~200 ุณุทุฑ
- **Documentation**: ~600 ุณุทุฑ
- **ุงููุฌููุน**: ~1300 ุณุทุฑ

### ุงููููุงุช:
- **ูููุงุช ุฌุฏูุฏุฉ**: 7
- **ูููุงุช ูุนุฏูุฉ**: 3
- **ุงููุฌููุน**: 10 ูููุงุช

### ุงูููุช ุงูููุฏุฑ:
- **ุงูููุฌุฒ**: ~4 ุณุงุนุงุช
- **ุงููุชุจูู**: ~2-3 ุณุงุนุงุช
- **ุงููุฌููุน**: ~6-7 ุณุงุนุงุช

## ๐ ุงูุฎุทูุงุช ุงูุชุงููุฉ

### ุงูุฃููููุฉ ุงูุนุงููุฉ:
1. โ ุชุดุบูู migration ูุชุญุฏูุซ ูุงุนุฏุฉ ุงูุจูุงูุงุช
2. โ ุงุฎุชุจุงุฑ Backend endpoints
3. โ ุงุฎุชุจุงุฑ Sidebar ูุน ุฃุฏูุงุฑ ูุฎุชููุฉ

### ุงูุฃููููุฉ ุงููุชูุณุทุฉ:
4. โ ุชุทููุฑ ุตูุญุฉ ุฅุฏุงุฑุฉ ุงููุณุชุฎุฏููู
5. โ ุฅูุดุงุก Route Guard Component
6. โ ุฅูุดุงุก ุตูุญุฉ Unauthorized

### ุงูุฃููููุฉ ุงูููุฎูุถุฉ:
7. โ ุฅุถุงูุฉ Unit Tests
8. โ ุฅุถุงูุฉ Integration Tests
9. โ ุชุญุณูู ุงูุฃุฏุงุก (ุฅุฐุง ูุฒู ุงูุฃูุฑ)

## ๐ ููุงุญุธุงุช ูููุฉ

### ูููุทูุฑ:
1. **ูุจู ุงูุชุดุบูู**: ุชุฃูุฏ ูู ุชุดุบูู seed ูุชุญุฏูุซ ุงูุฃุฏูุงุฑ
2. **ุงูุงุฎุชุจุงุฑ**: ุงุณุชุฎุฏู ุฃุฏูุงุฑ ูุฎุชููุฉ ููุชุฃูุฏ ูู ุนูู ุงููุธุงู
3. **ุงูุฃูุงู**: ูุง ุชูุณู ุฅุถุงูุฉ Route Guard ููุญูุงูุฉ ุงููุงููุฉ

### ูููุณุชุฎุฏู:
1. **ุงูุตูุงุญูุงุช**: ูุชู ุชุญุฏูุฏูุง ุนูุฏ ุฅูุดุงุก/ุชุนุฏูู ุงููุณุชุฎุฏู
2. **ุงูุดุงุดุงุช**: ุชุธูุฑ ููุท ุงูุดุงุดุงุช ุงููุตุฑุญ ุจูุง
3. **ุงููุตูู**: ูุญุงููุฉ ุงููุตูู ูุดุงุดุฉ ุบูุฑ ูุตุฑุญ ุจูุง ุชูุฑูุถ

## โจ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ ุงููุชููุนุฉ

ุนูุฏ ุงูุชูุงู ุงููุธุงู:
- โ ูู ูุณุชุฎุฏู ูุฑู ููุท ุงูุดุงุดุงุช ุงููุตุฑุญ ุจูุง
- โ ูุง ูููู ุงููุตูู ููุดุงุดุงุช ุบูุฑ ุงููุตุฑุญ ุจูุง
- โ ุณูููุฉ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช ูู ุตูุญุฉ ุงููุณุชุฎุฏููู
- โ ูุธุงู ุขูู ููุฑู ููุงุจู ููุชูุณุน

---

**ุขุฎุฑ ุชุญุฏูุซ**: $(date)
**ุงูุญุงูุฉ**: 60% ููุชูู
**ุงููุชุจูู**: Migration + ุตูุญุฉ ุงููุณุชุฎุฏููู + Route Guard + ุงูุงุฎุชุจุงุฑ
