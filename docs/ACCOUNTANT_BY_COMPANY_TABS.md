# ุดุงุดุฉ ุงููุญุงุณุจ: Tabs ุญุณุจ ุงูุดุฑูุฉ + ุฌููุน ุงูููุงุชูุฑ ุขุฌูุฉ

## ๐ฏ ุงูุชุบููุฑ ุงูุฑุฆูุณู

### โ ูุจู:
```
- ุงูููุงุชูุฑ ููุนุงู: ููุฏู (CASH) / ุขุฌู (CREDIT)
- ุดุงุดุฉ ุงููุญุงุณุจ:
  * Tab 1: ุงููุจูุนุงุช ุงูููุฏูุฉ (CASH)
  * Tab 2: ุงููุจูุนุงุช ุงูุขุฌูุฉ (CREDIT)
- ุฌููุน ุงูุดุฑูุงุช ูุฎููุทุฉ ูู ูู tab
```

### โ ุจุนุฏ:
```
- ุฌููุน ุงูููุงุชูุฑ ุขุฌูุฉ (CREDIT) ุชููุงุฆูุงู ุนูุฏ ุงูุฅูุดุงุก
- ุดุงุดุฉ ุงููุญุงุณุจ:
  * Tab 1: ููุงุชูุฑ ุงูุชูุงุฒู (ุดุฑูุฉ ุงูุชูุงุฒู)
  * Tab 2: ููุงุชูุฑ ุงูุฅูุงุฑุงุช (ุดุฑูุฉ ุงูุฅูุงุฑุงุช)
  * Tab N: ููุงุชูุฑ ุงูุดุฑูุฉ N
- ูู ุดุฑูุฉ ููุง tab ูููุตู
- ุฌููุน ุงูููุงุชูุฑ ุชูุนุงูู ูุขุฌูุฉ
```

---

## ๐ ุงูุชุบููุฑุงุช ุงูุชูุตูููุฉ

### 1. **Backend: ุฌุนู ุฌููุน ุงูููุงุชูุฑ ุขุฌูุฉ ุนูุฏ ุงูุฅูุดุงุก**

#### ุงูููู: `server/src/services/SalesService.ts` (ุงูุณุทุฑ 82-85)

**ูุจู:**
```typescript
saleType: null, // ุณููุญุฏุฏ ูุงุญูุงู
paymentMethod: null,
paidAmount: 0,
remainingAmount: 0,
```

**ุจุนุฏ:**
```typescript
saleType: 'CREDIT', // โ ุขุฌูุฉ ุฏุงุฆูุงู
paymentMethod: null,
paidAmount: 0,
remainingAmount: total, // โ ุงููุจูุบ ุงููุชุจูู = ุงููุฌููุน (ูู ููุฏูุน ุดูุก)
```

---

#### ุงูููู: `server/src/services/ComplexInterCompanySaleService.ts` (ุงูุณุทุฑ 350-354)

**ูุจู:**
```typescript
const customerSaleType = data.saleType || 'CREDIT';
const customerPaymentMethod = data.paymentMethod || null;
```

**ุจุนุฏ:**
```typescript
const customerSaleType = 'CREDIT'; // โ ุฌููุน ุงูููุงุชูุฑ ุขุฌูุฉ
const customerPaymentMethod = null; // ุณููุญุฏุฏ ูุงุญูุงู ุนูุฏ ุงูุงุนุชูุงุฏ
const customerPaidAmount = 0; // ูู ููุฏูุน ุดูุก
const customerRemainingAmount = customerSaleTotal; // ุงููุจูุบ ุงููุชุจูู = ุงููุฌููุน
```

---

### 2. **Frontend: ุฅุถุงูุฉ `companyId` ุฅูู `SalesQueryParams`**

#### ุงูููู: `client/src/state/salesApi.ts` (ุงูุณุทุฑ 92)

```typescript
export interface SalesQueryParams {
  page?: number;
  limit?: number;
  search?: string;
  customerId?: number;
  companyId?: number; // โ ููุชุฑ ุญุณุจ ุงูุดุฑูุฉ
  saleType?: "CASH" | "CREDIT";
  // ...
}
```

---

### 3. **Frontend: ุชุบููุฑ Tabs ูู ููุน ุงููุงุชูุฑุฉ ุฅูู ุงูุดุฑูุฉ**

#### ุงูููู: `client/src/app/accountant/page.tsx`

**ูุจู (ุงูุณุทุฑ 728-762):**
```tsx
<button onClick={() => setActiveTab('cash')}>
  <span>ุงููุจูุนุงุช ุงูููุฏูุฉ</span>
</button>
<button onClick={() => setActiveTab('credit')}>
  <span>ุงููุจูุนุงุช ุงูุขุฌูุฉ</span>
</button>
```

**ุจุนุฏ (ุงูุณุทุฑ 727-756):**
```tsx
{companiesData?.data?.companies?.map((company: any) => {
  const companyPendingCount = salesData?.data?.sales?.filter((s: Sale) => 
    s.companyId === company.id && s.status === 'DRAFT'
  ).length || 0;
  
  return (
    <button
      key={company.id}
      onClick={() => {
        setActiveCompanyId(company.id);
        setCurrentPage(1);
      }}
      className={`${
        activeCompanyId === company.id
          ? 'bg-blue-600 text-white shadow-md'
          : 'text-gray-600 hover:bg-gray-100'
      } flex-1 py-3 px-4 rounded-md...`}
    >
      <span>{company.name}</span>
      {companyPendingCount > 0 && (
        <span className="badge">{companyPendingCount}</span>
      )}
    </button>
  );
})}
```

---

### 4. **Frontend: ููุชุฑุฉ ุงูููุงุชูุฑ ุญุณุจ `activeCompanyId`**

#### ุงูููู: `client/src/app/accountant/page.tsx` (ุงูุณุทุฑ 85-105)

**ูุจู:**
```typescript
const { data: salesData } = useGetCashSalesQuery({
  page: currentPage,
  limit: 10,
  search: searchTerm || undefined,
  // ูุง ููุฌุฏ companyId filter
});
```

**ุจุนุฏ:**
```typescript
const { data: salesData } = useGetCashSalesQuery({
  page: currentPage,
  limit: 10,
  search: searchTerm || undefined,
  companyId: activeCompanyId, // โ ููุชุฑ ุญุณุจ ุงูุดุฑูุฉ ุงููุดุทุฉ
  receiptIssued: getReceiptIssuedFilter(),
  startDate: startDate || undefined,
  endDate: endDate || undefined
});
```

---

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

### **ุนูุฏ ุฅูุดุงุก ูุงุชูุฑุฉ:**

```
1๏ธโฃ ุงููุณุชุฎุฏู (ุงูุฅูุงุฑุงุช) ููุดุฆ ูุงุชูุฑุฉ:
   - ุตูู A: 10 ร 100 = 1000 ุฑ.ุณ
   
2๏ธโฃ ุงููุงุชูุฑุฉ ุชููุดุฃ ุชููุงุฆูุงู:
   - companyId: 2 (ุงูุฅูุงุฑุงุช)
   - saleType: CREDIT โ (ุขุฌูุฉ)
   - status: DRAFT
   - total: 1000
   - paidAmount: 0
   - remainingAmount: 1000 โ
   
3๏ธโฃ ุงููุงุชูุฑุฉ ุชุธูุฑ ูู ุดุงุดุฉ ุงููุญุงุณุจ:
   - Tab "ููุงุชูุฑ ุงูุฅูุงุฑุงุช"
   - ุฌุงูุฒุฉ ููุงุนุชูุงุฏ ูู ุงููุญุงุณุจ
```

---

### **ุดุงุดุฉ ุงููุญุงุณุจ:**

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ        ูุณุงุญุฉ ุนูู ุงููุญุงุณุจ           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โโโโโโโโโโโโฌโโโโโโโโโโโฌโโโโโโโโโโโ
โ  ุงูุชูุงุฒู  โ  ุงูุฅูุงุฑุงุช โ  ุดุฑูุฉ 3   โ โ Tabs
โ    (5)   โ    (3)   โ    (0)   โ
โโโโโโโโโโโโดโโโโโโโโโโโดโโโโโโโโโโโ
     โ          โ          โ
   ุนุฏุฏ ุงูููุงุชูุฑ ุงููุจุฏุฆูุฉ (DRAFT)

ุนูุฏ ุงูููุฑ ุนูู "ุงูุฅูุงุฑุงุช":
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ ุงูููุงุชูุฑ (ุฌููุนูุง ุขุฌูุฉ):
  โ ูุงุชูุฑุฉ #123 - ูุญูุฏ - 1000 ุฑ.ุณ
  โ ูุงุชูุฑุฉ #124 - ุฃุญูุฏ - 2500 ุฑ.ุณ
  โ ูุงุชูุฑุฉ #125 - ุนูู - 1800 ุฑ.ุณ
```

---

## ๐ ุงูุชุฏูู ุงููุงูู

### **ุณููุงุฑูู: ูุงุชูุฑุฉ ูุนูุฏุฉ (ุฅูุงุฑุงุช + ุชูุงุฒู)**

```
1๏ธโฃ ุงููุณุชุฎุฏู (ุงูุฅูุงุฑุงุช) ููุดุฆ ูุงุชูุฑุฉ:
   - ุตูู ุงูุชูุงุฒู A: 10 ร 100 = 1000 ุฑ.ุณ
   - ุตูู ุงูุฅูุงุฑุงุช B: 5 ร 200 = 1000 ุฑ.ุณ

2๏ธโฃ ุงููุธุงู ููุดุฆ 3 ููุงุชูุฑ (ูููุง ุขุฌูุฉ):

   ๐ ูุงุชูุฑุฉ ุงูุฅูุงุฑุงุช:
      - companyId: 2
      - saleType: CREDIT โ
      - total: 2000 ุฑ.ุณ
      - remainingAmount: 2000 ุฑ.ุณ
      
   ๐ ูุงุชูุฑุฉ ุงูุชูุงุฒู:
      - companyId: 1
      - saleType: CREDIT โ
      - total: 800 ุฑ.ุณ (ุณุนุฑ ุงูุฌููุฉ)
      - remainingAmount: 800 ุฑ.ุณ
      
   ๐ ูุงุชูุฑุฉ ุงููุดุชุฑูุงุช:
      - companyId: 2
      - purchaseType: CREDIT
      - total: 800 ุฑ.ุณ

3๏ธโฃ ูู ุดุงุดุฉ ุงููุญุงุณุจ:
   
   Tab "ุงูุชูุงุฒู" (1):
   โโ ูุงุชูุฑุฉ #124 (800 ุฑ.ุณ) โ ุงูุชูุงุฒู โ ุงูุฅูุงุฑุงุช
   
   Tab "ุงูุฅูุงุฑุงุช" (1):
   โโ ูุงุชูุฑุฉ #125 (2000 ุฑ.ุณ) โ ุงูุฅูุงุฑุงุช โ ูุญูุฏ
   
4๏ธโฃ ุงููุญุงุณุจ ูุนุชูุฏ ุงูููุงุชูุฑ:
   โ ุงุนุชูุงุฏ ูุงุชูุฑุฉ ุงูุฅูุงุฑุงุช โ ุฎุตู ุงููุฎุฒูู
   โ ุงุนุชูุงุฏ ูุงุชูุฑุฉ ุงูุชูุงุฒู โ ุฎุตู ุงููุฎุฒูู
```

---

## ๐ก ุงูููุงุฆุฏ

| ุงูููุฒุฉ | ุงููุตู |
|--------|--------|
| **ุชูุธูู ุฃูุถู** ๐ | ูู ุดุฑูุฉ ููุง tab ูููุตู |
| **ูุถูุญ ุฃูุซุฑ** ๐ฏ | ุงููุญุงุณุจ ูุฑู ููุงุชูุฑ ูู ุดุฑูุฉ ุจุดูู ูููุตู |
| **ููุทู ููุญูุฏ** โ | ุฌููุน ุงูููุงุชูุฑ ุขุฌูุฉ (ูุง ุญุงุฌุฉ ููุชูููุฒ) |
| **ุณูููุฉ ุงูุงุณุชุฎุฏุงู** ๐ | ุงูุงูุชูุงู ุจูู ุงูุดุฑูุงุช ุจููุฑุฉ ูุงุญุฏุฉ |

---

## ๐ ุงููููุงุช ุงููุนุฏูุฉ

```
โ server/src/services/SalesService.ts
   - createSale(): saleType = 'CREDIT' ุฏุงุฆูุงู
   
โ server/src/services/ComplexInterCompanySaleService.ts
   - createComplexInterCompanySale(): ุฌููุน ุงูููุงุชูุฑ CREDIT
   
โ client/src/state/salesApi.ts
   - SalesQueryParams: ุฅุถุงูุฉ companyId
   
โ client/src/app/accountant/page.tsx
   - Tabs: ุชุบููุฑ ูู ููุน ุงููุงุชูุฑุฉ ุฅูู ุงูุดุฑูุฉ
   - ุงุณุชุฎุฏุงู activeCompanyId ููููุชุฑุฉ
   - ุฅุฒุงูุฉ activeTab state
```

---

## ๐ ุญุงูุฉ ุงููุธุงู

```
โ ุฅูุดุงุก ูุงุชูุฑุฉ: CREDIT ุจุฏูู ุฎุตู ูุฎุฒูู
โ ุฌููุน ุงูููุงุชูุฑ: ุขุฌูุฉ ุชููุงุฆูุงู
โ ุดุงุดุฉ ุงููุญุงุณุจ: tabs ุญุณุจ ุงูุดุฑูุฉ
โ ุงูููุชุฑุฉ: ุญุณุจ activeCompanyId
โ ุงูุงุนุชูุงุฏ: ูุนูู ููู ุดุฑูุฉ ุนูู ุญุฏุฉ
โ ุงููุจูุบ ุงููุชุจูู: ูุชุญุฏุซ ุชููุงุฆูุงู
โ ุณุนุฑ ุงูุฌููุฉ: ุซุงุจุช ููููุงุชูุฑ ุงูุชููุงุฆูุฉ
โ ุงูุฎุงุฏู: ูุนูู ุนูู ุงููููุฐ 4000 โจ
โ ุงูุนููู: ูุนูู ุนูู ุงููููุฐ 3030 โจ
```

---

**ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 5 ููููุจุฑ 2025  
**ุงูุญุงูุฉ:** โ ููุทุจูู ููุนูู  
**ุงูุชุฃุซูุฑ:** ๐ ุชูุธูู ุฃูุถู ูุดุงุดุฉ ุงููุญุงุณุจ + ููุทู ููุญูุฏ ููููุงุชูุฑ

